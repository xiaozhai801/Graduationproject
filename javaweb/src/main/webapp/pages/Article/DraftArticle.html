<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>文章草稿</title>
<link href="../..//layui/css/layui.css" rel="stylesheet">
<script src="../..//layui/layui.js"></script>
<script src="../..//js/jquery-3.6.0.min.js"></script>
</head>
<style>
html, body {
	/* overflow-x: hidden; */
	overflow: hidden;
}
</style>
<body>
	<form class="layui-form layui-row layui-col-space16">
		<div class="layui-form-item">
			<div class="layui-input-inline">
				<div class="layui-inline">
					<input type="text" name="draftId" value="" placeholder="草稿ID"
						class="layui-input" lay-affix="clear" style="width: 150px;">
				</div>
			</div>

			<div class="layui-input-inline">
				<div class="layui-inline">
					<input type="text" name="topic" placeholder="标题" lay-affix="clear"
						class="layui-input" style="width: 150px;">
				</div>
			</div>

			<div class="layui-input-inline">
				<div class="layui-btn-container">
					<button class="layui-btn demo-dropdown-base" style="width: 120px;">
						<span>机型</span> <i
							class="layui-icon layui-icon-down layui-font-12"></i>
					</button>
				</div>
				<!-- 添加隐藏的 input 字段用于保存机型值 -->
				<input type="hidden" name="model" id="modelInput">
			</div>

			<div class="layui-input-inline">
				<div class="layui-btn-container">
					<button class="layui-btn" lay-submit lay-filter="demo-table-search">
						<i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
					</button>
				</div>
			</div>

			<div class="layui-input-inline">
				<div class="layui-btn-container">
					<a href="UploadArticle.html" class="layui-btn layui-bg-red">前往创作中心</a>
				</div>
			</div>
		</div>
	</form>

	<table class="layui-hide" id="ID-table-demo-search"></table>


	<script>
		layui.use(function() {
			var table = layui.table;
			var form = layui.form;
			var laydate = layui.laydate;
			var dropdown = layui.dropdown;
			// 创建表格实例
			table.render({
				elem : '#ID-table-demo-search',
				url : '../../SelectMyDraftArticleServlet', // 此处为静态模拟数据，实际使用时需换成真实接口
				page : true,
				cols : [ [ {
					field : 'draftId',
					title : '草稿ID',
					width : 150,
					sort : true,
					fixed : true
				}, {
					field : 'topic',
					title : '标题',
					width : 650,
					templet : function(d) {
						var link = "../../ShowArticleServlet?draftId=" + d.draftId;
						return '<a href="' + link + '">' + d.topic + '</a>';
					}
				}, {
					field : 'name',
					title : '作者',
					width : 120,
					sort : true
				}, {
					field : 'model',
					title : '机型',
					width : 100
				}, {
					field : 'data_text',
					title : '草稿内容',
					width : 694
				} ] ],
				height : 'full-55'
			});
			// 日期
			laydate.render({
				elem : '.demo-table-search-date'
			});
			// 自定义事件
			dropdown.render({
				elem : '.demo-dropdown-base', // 初始加载数据的 Servlet
				data : [ {
					title : '手机',
					id : 100
				}, {
					title : '笔记本电脑',
					id : 101
				}, {
					title : '游戏主机',
					id : 102
				}, {
					title : '家用电器',
					id : 103
				}, {
					title : '汽车和卡车',
					id : 104
				} ],
				click : function(obj) {
					this.elem.find('span').text(obj.title);
					// 更新隐藏 input 字段的值
					$('#modelInput').val(obj.title);
				}
			});
			// 搜索提交
			form.on('submit(demo-table-search)', function(data) {
				var field = data.field; // 获得表单字段
				// 执行搜索重载
				table.reload('ID-table-demo-search', {
					page : {
						curr : 1
					// 重新从第 1 页开始
					},
					url : '../../SearchMyDraftArticleServlet',
					where : field
				// 搜索的字段
				});
				return false; // 阻止默认 form 跳转
			});
		});
	</script>

</body>

</html>