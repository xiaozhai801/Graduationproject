<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>所有文章</title>
    <link href="../../layui/css/layui.css" rel="stylesheet">
    <script src="../../layui/layui.js"></script>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <style>
        html,body {
            overflow: hidden;
        }

        /* 自定义表格样式 */
        .layui-table-cell {
            height: auto;
            padding: 12px 15px;
            line-height: 1.6;
        }

        /* 标题样式 */
        .article-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e9fff;
            transition: color 0.3s;
            display: block;
            margin-bottom: 5px;
        }
        .article-title:hover {
            color: #009688;
            text-decoration: underline;
        }

        /* 作者样式 */
        .article-author {
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }

        /* 机型标签 */
        .article-model {
            display: inline-block;
            padding: 4px 10px;
            background: #f8f8f8;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
            border: 1px solid #eee;
        }

        /* 数据统计 */
        .article-stats {
            font-size: 13px;
            color: #999;
        }
        .article-stats i {
            margin-right: 5px;
            font-size: 14px;
        }

        /* 日期样式 */
        .article-date {
            color: #888;
            font-size: 13px;
            display: block;
            margin-top: 3px;
        }

        /* 行悬停效果 */
        .layui-table tbody tr:hover {
            background-color: #fafafa !important;
        }
    </style>
</head>
<body>
    <form class="layui-form layui-row layui-col-space16">
        <div class="layui-form-item">
            <div class="layui-input-inline">
                <input type="text" name="titleId" placeholder="文章ID" class="layui-input" style="width: 150px;">
            </div>
            <div class="layui-input-inline">
                <input type="text" name="topic" placeholder="标题" class="layui-input" style="width: 150px;">
            </div>
            <div class="layui-input-inline">
                <input type="text" name="name" placeholder="作者" class="layui-input" style="width: 150px;">
            </div>
            <div class="layui-input-inline">
                <button class="layui-btn demo-dropdown-base" type="button" style="width: 120px;">
                    <span>机型</span> <i class="layui-icon layui-icon-down layui-font-12"></i>
                </button>
                <input type="hidden" name="model" id="modelInput">
            </div>
            <div class="layui-input-inline">
                <button class="layui-btn" lay-submit lay-filter="demo-table-search">
                    <i class="layui-icon layui-icon-search"></i>
                </button>
            </div>
        </div>
    </form>

    <table class="layui-hide" id="ID-table-demo-search"></table>

    <script>
        layui.use(['table', 'form', 'dropdown'], function(){
            var table = layui.table;
            var form = layui.form;
            var dropdown = layui.dropdown;

            // 初始化表格
            table.render({
                elem: '#ID-table-demo-search',
                url: '../../SelectAllArticleServlet',
                page: true,
                cols: [[
                    {field: 'topic', title: '标题', width: 740, templet: function(d){
                        return '<a href="CurrentArticle.html?titleId=' + d.titleId + '" class="article-title">' + d.topic + 
                               '</a><span class="article-date">' + d.uploadTime + '</span>';
                    }},
                    {field: 'name', title: '作者', width: 150, templet: '<div class="article-author">{{d.name}}</div>'},
                    {field: 'model', title: '机型', width: 150, templet: '<div class="article-model">{{d.model}}</div>'},
                    {field: 'views', title: '浏览', width: 120, templet: function(d){
                        return '<div class="article-stats"><i class="layui-icon layui-icon-read"></i>' + d.views + '</div>';
                    }},
                    {field: 'likes', title: '点赞', width: 120, templet: function(d){
                        return '<div class="article-stats"><i class="layui-icon layui-icon-praise"></i>' + d.likes + '</div>';
                    }}
                ]],
                height: 'full-55',
                parseData: function(res){
                    if(res.code === 0){
                        res.data = res.data.filter(function(item){
                            return item.release == 1;
                        });
                    }
                    return res;
                }
            });

            // 初始化机型下拉
            dropdown.render({
                elem: '.demo-dropdown-base',
                data: [
                    {title: '手机', id: 100},
                    {title: '笔记本电脑', id: 101},
                    {title: '游戏主机', id: 102}
                ],
                click: function(obj){
                    this.elem.find('span').text(obj.title);
                    $('#modelInput').val(obj.title);
                }
            });

            // 搜索功能
            form.on('submit(demo-table-search)', function(data){
                table.reload('ID-table-demo-search', {
                    page: {curr: 1},
                    url: '../../SearchArticleServlet',
                    where: data.field
                });
                return false;
            });
        });
    </script>
</body>
</html>