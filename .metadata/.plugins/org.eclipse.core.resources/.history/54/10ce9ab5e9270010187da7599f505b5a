package com.zpq.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import com.zpq.pojo.Article;
import com.zpq.pojo.Draft;
import com.zpq.utils.DBUtil;
import java.sql.Timestamp;
import java.io.StringReader;

public class ArticleDaoImpl implements ArticleDao {

	@Override
	public List<Object> selectArticle(int page, int limit) throws SQLException {
		// 用于存储查询到的文章对象的列表
		List<Object> articleList = new ArrayList<>();
		// 创建数据库工具类实例，用于获取数据库连接和操作数据库
		DBUtil dbUtil = new DBUtil();
		// SQL语句，使用LIMIT进行分页查询，?为占位符
		String sql = "SELECT vo.titleId,topic,`name`,uploadTime,model,(SELECT COUNT(*) FROM c_useractions WHERE titleId = vo.titleId) AS views,cs.likeCount FROM v_articleinfo vo LEFT JOIN c_actioncounts cs ON vo.titleId = cs.titleId LIMIT ?,?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 设置LIMIT子句的第一个参数，即偏移量，(page - 1) * limit计算出从哪条数据开始查询
		ps.setInt(1, (page - 1) * limit);
		// 设置LIMIT子句的第二个参数，即每页显示的记录数
		ps.setInt(2, limit);
		ResultSet rs = ps.executeQuery();
		while (rs.next()) {
			Article article = new Article();
			article.setTitleId(rs.getInt("titleId"));
//			article.setUserId(rs.getString("userId"));
			article.setName(rs.getString("name"));
			article.setTopic(rs.getString("topic"));
			article.setModel(rs.getString("model"));
			article.setUploadTime(rs.getString("uploadTime"));
			article.setRelease(rs.getInt("release"));
			article.setViews(rs.getInt("views"));
			article.setLikes(rs.getInt("likes"));
			articleList.add(article);
		}
		// 返回查询到的文章对象列表
		return articleList;
	}

	// 获取所有文章数量的方法
	@Override
	public int countArticle() throws SQLException {
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL语句，统计v_articleinfo表中的记录数量，使用count(*)函数，并将结果命名为sum
		String sql = "SELECT count(*) as sum FROM v_articleinfo";
		// 获取数据库连接
		Connection conn = dbUtil.getConnection();
		// 因为SQL语句中没有占位符，所以使用Statement对象执行SQL语句
		java.sql.Statement st = conn.createStatement();
		// 执行SQL查询，并获取结果集
		ResultSet rs = st.executeQuery(sql);
		// 遍历结果集，获取统计的文章数量并返回
		while (rs.next()) {
			return rs.getInt("sum");
		}
		// 如果没有查询到结果，返回0
		return 0;
	}

	@Override
	public List<Object> searchArticle(Article article, int page, int limit) throws SQLException {
		// 用于存储搜索到的文章对象的列表
		List<Object> searchArticleList = new ArrayList<>();
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// 使用StringBuilder构建SQL查询语句，初始语句为查询所有记录的基础部分，并添加WHERE 1=1方便后续拼接条件
		StringBuilder sqlBuilder = new StringBuilder("SELECT * FROM v_articleinfo WHERE 1=1");
		int titleId = article.getTitleId();
		String topic = article.getTopic();
		String name = article.getName();
		String model = article.getModel();
		int release = article.getRelease();
		List<Object> params = new ArrayList<>();

		// 如果文章ID不为-1，说明有文章ID的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (titleId != -1) {
			sqlBuilder.append(" AND CAST(titleId AS CHAR) LIKE ?");
			params.add("%" + titleId + "%");
		}
		// 如果文章标题不为null，说明有文章标题的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (topic != null) {
			sqlBuilder.append(" AND topic LIKE ?");
			params.add("%" + topic + "%");
		}
		// 如果文章作者不为null，说明有文章作者的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (name != null) {
			sqlBuilder.append(" AND name LIKE ?");
			params.add("%" + name + "%");
		}
		// 如果文章机型不为null，说明有文章机型的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (model != null) {
			sqlBuilder.append(" AND model LIKE ?");
			params.add("%" + model + "%");
		}
		// 如果文章审核状态不为-1，说明有文章机型的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (release != -1) {
			sqlBuilder.append(" AND `release` = ?");
			params.add(release);
		}

		// 添加分页查询的LIMIT子句到SQL语句中，并将分页参数值添加到params列表
		sqlBuilder.append(" LIMIT ?,?");
		params.add((page - 1) * limit);
		params.add(limit);

		// 将StringBuilder中的内容转换为完整的SQL语句字符串
		String sql = sqlBuilder.toString();

		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 遍历params列表，为预编译语句的占位符设置对应的参数值
		for (int i = 0; i < params.size(); i++) {
			ps.setObject(i + 1, params.get(i));
		}

		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到searchArticleList中
		while (rs.next()) {
			Article searchArticle = new Article();
			searchArticle.setTitleId(rs.getInt("titleId"));
			searchArticle.setUserId(rs.getString("userId"));
			searchArticle.setName(rs.getString("name"));
			searchArticle.setTopic(rs.getString("topic"));
			searchArticle.setModel(rs.getString("model"));
			searchArticle.setUploadTime(rs.getString("uploadTime"));
			searchArticle.setRelease(rs.getInt("release"));
			searchArticle.setViews(rs.getInt("views"));
			searchArticle.setLikes(rs.getInt("likes"));
			searchArticleList.add(searchArticle);
		}
		// 返回搜索到的文章对象列表
		return searchArticleList;
	}

	@Override
	public List<Object> selectMyArticle(String userId, int page, int limit) throws SQLException {
		// 用于存储查询到的文章对象的列表
		List<Object> articleList = new ArrayList<>();
		// 创建数据库工具类实例，用于获取数据库连接和操作数据库
		DBUtil dbUtil = new DBUtil();
		// SQL语句，使用LIMIT进行分页查询，?为占位符
		String sql = "SELECT * FROM v_articleinfo where userId=? LIMIT ?,?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 设置where字句的第一个参数,即查询的用户
		ps.setString(1, userId);
		// 设置LIMIT子句的第一个参数，即偏移量，(page - 1) * limit计算出从哪条数据开始查询
		ps.setInt(2, (page - 1) * limit);
		// 设置LIMIT子句的第二个参数，即每页显示的记录数
		ps.setInt(3, limit);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到articleList中
		while (rs.next()) {
			Article article = new Article();
			article.setTitleId(rs.getInt("titleId"));
			article.setUserId(rs.getString("userId"));
			article.setName(rs.getString("name"));
			article.setTopic(rs.getString("topic"));
			article.setModel(rs.getString("model"));
			article.setUploadTime(rs.getString("uploadTime"));
			article.setRelease(rs.getInt("release"));
			article.setViews(rs.getInt("views"));
			article.setLikes(rs.getInt("likes"));
			articleList.add(article);
		}
		// 返回查询到的文章对象列表
		return articleList;
	}

	@Override
	public int countMyArticle(String userId) throws SQLException {
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL语句，统计v_articleinfo表中的记录数量，使用count(*)函数，并将结果命名为sum
		String sql = "SELECT count(*) as sum FROM v_articleinfo where userId = ?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setString(1, userId);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，获取统计的文章数量并返回
		while (rs.next()) {
			return rs.getInt("sum");
		}
		// 如果没有查询到结果，返回0
		return 0;
	}

	@Override
	public List<Object> searchMyArticle(Article article, int page, int limit) throws SQLException {
		// 用于存储搜索到的文章对象的列表
		List<Object> searchArticleList = new ArrayList<>();
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// 使用StringBuilder构建SQL查询语句，初始语句为查询所有记录的基础部分，并添加WHERE 1=1方便后续拼接条件
		StringBuilder sqlBuilder = new StringBuilder("SELECT * FROM v_articleinfo WHERE 1=1");
		int titleId = article.getTitleId();
		String topic = article.getTopic();
		String userId = article.getUserId();
		String model = article.getModel();
		List<Object> params = new ArrayList<>();

		// 如果文章ID不为-1，说明有文章ID的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (titleId != -1) {
			sqlBuilder.append(" AND CAST(titleId AS CHAR) LIKE ?");
			params.add("%" + titleId + "%");
		}
		// 如果文章标题不为null，说明有文章标题的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (topic != null) {
			sqlBuilder.append(" AND topic LIKE ?");
			params.add("%" + topic + "%");
		}
		// 文章作者ID的查询条件，添加到SQL语句中，并将参数值添加到params列表
		sqlBuilder.append(" AND userId = ?");
		params.add(userId);
		// 如果文章机型不为null，说明有文章机型的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (model != null) {
			sqlBuilder.append(" AND model LIKE ?");
			params.add("%" + model + "%");
		}

		// 添加分页查询的LIMIT子句到SQL语句中，并将分页参数值添加到params列表
		sqlBuilder.append(" LIMIT ?,?");
		params.add((page - 1) * limit);
		params.add(limit);

		// 将StringBuilder中的内容转换为完整的SQL语句字符串
		String sql = sqlBuilder.toString();

		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 遍历params列表，为预编译语句的占位符设置对应的参数值
		for (int i = 0; i < params.size(); i++) {
			ps.setObject(i + 1, params.get(i));
		}

		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到searchArticleList中
		while (rs.next()) {
			Article searchArticle = new Article();
			searchArticle.setTitleId(rs.getInt("titleId"));
			searchArticle.setUserId(rs.getString("userId"));
			searchArticle.setName(rs.getString("name"));
			searchArticle.setTopic(rs.getString("topic"));
			searchArticle.setModel(rs.getString("model"));
			searchArticle.setUploadTime(rs.getString("uploadTime"));
			searchArticle.setRelease(rs.getInt("release"));
			searchArticle.setViews(rs.getInt("views"));
			searchArticle.setLikes(rs.getInt("likes"));
			searchArticleList.add(searchArticle);
		}
		// 返回搜索到的文章对象列表
		return searchArticleList;
	}

	@Override
	public List<Object> selectArticle(int page, int limit, String model) throws SQLException {
		// 用于存储查询到的文章对象的列表
		List<Object> articleList = new ArrayList<>();
		// 创建数据库工具类实例，用于获取数据库连接和操作数据库
		DBUtil dbUtil = new DBUtil();
		// SQL语句，使用LIMIT进行分页查询，?为占位符
		String sql = "SELECT * FROM v_articleinfo where model=? LIMIT ?,?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setString(1, model);
		// 设置LIMIT子句的第一个参数，即偏移量，(page - 1) * limit计算出从哪条数据开始查询
		ps.setInt(2, (page - 1) * limit);
		// 设置LIMIT子句的第二个参数，即每页显示的记录数
		ps.setInt(3, limit);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到articleList中
		while (rs.next()) {
			Article article = new Article();
			article.setTitleId(rs.getInt("titleId"));
			article.setUserId(rs.getString("userId"));
			article.setName(rs.getString("name"));
			article.setTopic(rs.getString("topic"));
			article.setModel(rs.getString("model"));
			article.setUploadTime(rs.getString("uploadTime"));
			article.setRelease(rs.getInt("release"));
			article.setViews(rs.getInt("views"));
			article.setLikes(rs.getInt("likes"));
			articleList.add(article);
		}
		// 返回查询到的文章对象列表
		return articleList;
	}

	@Override
	public int uploadArticle(Draft draft) throws SQLException {
		// TODO Auto-generated method stub
		DBUtil dbUtil = new DBUtil();
		// 始化 SQL 语句和 PreparedStatement
		String sql = "INSERT INTO v_articledraft (draftId,topic,userId,v_articledraft.`name`,model,typeId,data_html,data_text) values (?,?,?,?,?,?,?,?)";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql); // 重新获取 PreparedStatement
		ps.setInt(1, draft.getDraftId());
		ps.setString(2, draft.getTopic());
		ps.setString(3, draft.getUserId());
		ps.setString(4, draft.getName());
		ps.setString(5, draft.getModel());
		ps.setInt(6, draft.getTypeId());
		ps.setString(7, draft.getData_html());
		ps.setString(8, draft.getData_text());
		// 执行插入操作，对于插入语句使用 executeUpdate
		int rowsAffected = ps.executeUpdate();
		// 检查是否插入成功
		if (rowsAffected > 0) {
			return 1;
		} else {
			return -1;
		}
	}

	@Override
	public List<Object> selectMyDraftArticle(String userId, int page, int limit) throws SQLException {
		// 用于存储查询到的文章对象的列表
		List<Object> draftArticle = new ArrayList<>();
		// 创建数据库工具类实例，用于获取数据库连接和操作数据库
		DBUtil dbUtil = new DBUtil();
		// SQL语句，使用LIMIT进行分页查询，?为占位符
		String sql = "SELECT * FROM v_articledraft where userId=? LIMIT ?,?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 设置where字句的第一个参数,即查询的用户
		ps.setString(1, userId);
		// 设置LIMIT子句的第一个参数，即偏移量，(page - 1) * limit计算出从哪条数据开始查询
		ps.setInt(2, (page - 1) * limit);
		// 设置LIMIT子句的第二个参数，即每页显示的记录数
		ps.setInt(3, limit);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到articleList中
		while (rs.next()) {
			Draft draft = new Draft();
			draft.setDraftId(rs.getInt("draftId"));
			draft.setTopic(rs.getString("topic"));
			draft.setName(rs.getString("name"));
			draft.setModel(rs.getString("model"));
			draft.setData_text(rs.getString("data_text"));
			draftArticle.add(draft);
		}
		// 返回查询到的文章对象列表
		return draftArticle;
	}

	@Override
	public int countMyDraftArticle(String userId) throws SQLException {
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL语句，统计v_articleinfo表中的记录数量，使用count(*)函数，并将结果命名为sum
		String sql = "SELECT count(*) as sum FROM v_articledraft where userId = ?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setString(1, userId);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，获取统计的文章数量并返回
		while (rs.next()) {
			return rs.getInt("sum");
		}
		// 如果没有查询到结果，返回0
		return 0;
	}

	@Override
	public List<Object> searchMyDraftArticle(Draft draft, int page, int limit) throws SQLException {
		// 用于存储搜索到的文章对象的列表
		List<Object> searchDraftArticleList = new ArrayList<>();
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// 使用StringBuilder构建SQL查询语句，初始语句为查询所有记录的基础部分，并添加WHERE 1=1方便后续拼接条件
		StringBuilder sqlBuilder = new StringBuilder("SELECT * FROM v_articledraft WHERE 1=1");
		int draftId = draft.getDraftId();
		String topic = draft.getTopic();
		String model = draft.getModel();
		String userId = draft.getUserId();
		List<Object> params = new ArrayList<>();

		// 如果文章ID不为-1，说明有文章ID的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (draftId != -1) {
			sqlBuilder.append(" AND CAST(draftId AS CHAR) LIKE ?");
			params.add("%" + draftId + "%");
		}
		// 如果文章标题不为null，说明有文章标题的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (topic != null) {
			sqlBuilder.append(" AND topic LIKE ?");
			params.add("%" + topic + "%");
		}
		// 文章作者ID的查询条件，添加到SQL语句中，并将参数值添加到params列表
		sqlBuilder.append(" AND userId = ?");
		params.add(userId);
		// 如果文章机型不为null，说明有文章机型的查询条件，添加到SQL语句中，并将参数值添加到params列表
		if (model != null) {
			sqlBuilder.append(" AND model LIKE ?");
			params.add("%" + model + "%");
		}

		// 添加分页查询的LIMIT子句到SQL语句中，并将分页参数值添加到params列表
		sqlBuilder.append(" LIMIT ?,?");
		params.add((page - 1) * limit);
		params.add(limit);

		// 将StringBuilder中的内容转换为完整的SQL语句字符串
		String sql = sqlBuilder.toString();

		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		// 遍历params列表，为预编译语句的占位符设置对应的参数值
		for (int i = 0; i < params.size(); i++) {
			ps.setObject(i + 1, params.get(i));
		}

		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，将每一条记录封装成Article对象并添加到searchArticleList中
		while (rs.next()) {
			Draft searchDraft = new Draft();
			searchDraft.setDraftId(rs.getInt("draftId"));
			searchDraft.setTopic(rs.getString("topic"));
			searchDraft.setName(rs.getString("name"));
			searchDraft.setModel(rs.getString("model"));
			searchDraft.setData_text(rs.getString("data_text"));
			searchDraftArticleList.add(searchDraft);
		}
		// 返回搜索到的文章对象列表
		return searchDraftArticleList;
	}

	@Override
	public int deleteDraftArticle(int draftId, String userId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL删除语句
		String sql = "DELETE FROM v_articledraft WHERE draftId = ? AND userId = ?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, draftId);
		ps.setString(2, userId);
		// 执行SQL删除操作，并获取受影响的行数
		// 1 删除成功,0 删除失败
		int row = ps.executeUpdate();
		return row;
	}

	@Override
	public int UploadArticleReview(int draftId, String userId) throws SQLException {
		// TODO Auto-generated method stub
		// 获取上传文章草稿相关信息
		SearchElementDao searchElementDao = new SearchElementDaoImpl();
		Map<Integer, Draft> draftInfoMap = searchElementDao.searchDraftInfo("draftId", draftId);
		Draft draftInfo = draftInfoMap.get(draftId);
		// 获取当前时间戳
		Timestamp uploadTime = new Timestamp(System.currentTimeMillis());

		// 处理长字符串
		StringReader htmlReader = new StringReader(draftInfo.getData_html());
		StringReader textReader = new StringReader(draftInfo.getData_text());

		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL添加语句
		String uploadSql = "INSERT INTO v_articleinfo (titleId, userId, NAME, topic, model, uploadTime, data_html, data_text) VALUES (?,?,?,?,?,?,?,?)";
		PreparedStatement ps = dbUtil.getPreparedStatement(uploadSql);
		ps.setInt(1, draftInfo.getDraftId());
		ps.setString(2, draftInfo.getUserId());
		ps.setString(3, draftInfo.getName());
		ps.setString(4, draftInfo.getTopic());
		ps.setString(5, draftInfo.getModel());
		ps.setTimestamp(6, uploadTime);
		ps.setCharacterStream(7, htmlReader, draftInfo.getData_html().length());
		ps.setCharacterStream(8, textReader, draftInfo.getData_text().length());

		int row = ps.executeUpdate();
		if (row == 0) {
			return -1;
		}

		// SQL删除草稿文章语句
		String deleteSql = "DELETE FROM v_articledraft WHERE draftId = ? AND userId = ?";
		ps = dbUtil.getPreparedStatement(deleteSql);
		ps.setInt(1, draftId);
		ps.setString(2, userId);
		row = ps.executeUpdate();

		return row;
	}

	@Override
	public int countDraft(String element, String value) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL语句，统计v_articleinfo表中的记录数量，使用count(*)函数，并将结果命名为sum
		String sql = "SELECT count(*) as sum FROM v_articledraft where " + element + "=?";
		// 获取预编译的SQL语句对象
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setString(1, value);
		// 执行SQL查询，并获取结果集
		ResultSet rs = ps.executeQuery();
		// 遍历结果集，获取统计的文章数量并返回
		while (rs.next()) {
			return rs.getInt("sum");
		}
		// 如果没有查询到结果，返回0
		return 0;
	}

	@Override
	public int deleteArticle(int titleId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL删除语句
		String sql = "DELETE FROM v_articleinfo WHERE titleId = ?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, titleId);
		// 执行SQL删除操作，并获取受影响的行数
		// 1 删除成功,0 删除失败
		int row = ps.executeUpdate();
		return row;
	}

	@Override
	public int deleteArticle(int titleId, String userId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL删除语句
		String sql = "DELETE FROM v_articleinfo WHERE titleId = ? AND userId = ?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, titleId);
		ps.setString(2, userId);
		// 执行SQL删除操作，并获取受影响的行数
		// 1 删除成功,0 删除失败
		int row = ps.executeUpdate();
		return row;
	}

	@Override
	public int ReviewNotPassArticle(int titleId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL修改语句
		String sql = "UPDATE v_articleinfo SET `release` = 2 WHERE titleId = ?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, titleId);
		// 执行SQL修改操作，并获取受影响的行数
		// 1 修改成功,0 修改失败
		int row = ps.executeUpdate();
		return row;
	}

	@Override
	public int ReviewPassArticle(int titleId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL修改语句
		String sql = "UPDATE v_articleinfo SET `release` = 1 WHERE titleId = ?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, titleId);
		// 执行SQL修改操作，并获取受影响的行数
		// 1 修改成功,0 修改失败
		int row = ps.executeUpdate();
		return row;
	}

	@Override
	public int UploadTitleId(int titleId) throws SQLException {
		// TODO Auto-generated method stub
		// 创建数据库工具类实例
		DBUtil dbUtil = new DBUtil();
		// SQL新增语句
		String sql = "INSERT into c_actioncounts (titleId) VALUES (?)";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, titleId);
		// 执行SQL新增操作，并获取受影响的行数
		// 1 新增成功,0 新增失败
		int row = ps.executeUpdate();
		return row;
	}
}