<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>我的点赞</title>
<link href="../../layui/css/layui.css" rel="stylesheet">
<script src="../../layui/layui.js"></script>
<script src="../../js/jquery-3.6.0.min.js"></script>
<style>
.layui-nav.layui-nav-tree {
	position: fixed;
	left: 0;
	top: 0;
	width: 200px;
	overflow-y: auto;
}

.layui-form {
	margin-left: 220px;
	padding: 20px;
}

#favorite-list {
	margin-top: 20px;
}

.layui-card {
	box-shadow: 0 2px 4px rgba(0, 0, 0, .1);
	border-radius: 4px;
}

.layui-card-header {
	border-bottom: 1px solid #f0f0f0;
	padding: 15px 20px;
}

.layui-card-body {
	padding: 20px;
	line-height: 1.6;
}

.layui-empty {
	text-align: center;
	color: #999;
	padding: 50px 0;
}
</style>
</head>

<body>
	<ul class="layui-nav layui-nav-tree">
		<li class="layui-nav-item"><a href="PersonalInfo.html">个人信息</a></li>
		<li class="layui-nav-item"><a href="EditPassword.html">修改密码</a></li>
		<li class="layui-nav-item"><a href="MyFavorite.html">我的收藏</a></li>
		<li class="layui-nav-item"><a href="MyLike">我的点赞</a></li>
	</ul>
	<div id="favorite-list" class="layui-form"></div>

	<script>
        $(document).ready(function () {
            $.ajax({
                url: '../../SelectMyFavoriteServlet',
                method: 'GET',
                dataType: 'json',
                success: function (response) {
                    const favoriteList = $('#favorite-list');
                    favoriteList.empty();

                    // 检查数据有效性
                    if (!response.data ||!Array.isArray(response.data)) {
                        return favoriteList.html('<div class="layui-empty">数据格式错误</div>');
                    }

                    if (response.data.length > 0) {
                        response.data.forEach(item => {
                            const card = $(`
                                <div class="layui-card" style="margin-bottom: 20px;">
                                    <div class="layui-card-header">
                                        <h2 style="font-size: 20px; margin-bottom: 5px;"><a href="../Article/CurrentArticle.html?titleId=${item.titleId}">${item.topic || '无标题'}</a></h2>
                                        <div style="color: #666; font-size: 12px;">
                                            <span>作者：${item.name || '匿名'}</span>
                                            <span style="margin-left: 15px;">发布于：${item.uploadTime || '未知时间'}</span>
                                        </div>
                                    </div>
                                    <div class="layui-card-body">
                                        <div style="margin-top: 15px; color: #888; font-size: 12px;">
                                            <span>浏览：${item.views || 0}</span>
                                            <span style="margin-left: 15px;">收藏：${item.favorites || 0}</span>
                                            <span style="margin-left: 15px;">点赞：${item.likes || 0}</span>
                                        </div>
                                    </div>
                                </div>
                            `);
                            favoriteList.append(card);
                        });
                    } else {
                        favoriteList.html('<div class="layui-empty">暂无收藏内容</div>');
                    }
                },
                error: function () {
                    $('#favorite-list').html('<div class="layui-empty">获取收藏数据失败</div>');
                }
            });
        });
    </script>
</body>

</html>