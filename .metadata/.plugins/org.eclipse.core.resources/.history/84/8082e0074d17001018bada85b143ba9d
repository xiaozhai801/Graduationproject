package com.zpq.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.zpq.pojo.Article;
import com.zpq.pojo.User;
import com.zpq.utils.DBUtil;

public class ArticleDaoImpl implements ArticleDao {

	@Override
	public List<Object> selectArticle(int page, int limit) throws SQLException {
		// TODO Auto-generated method stub
		List<Object> articleList=new ArrayList<>();
		DBUtil dbUtil = new DBUtil();
		String sql = "SELECT * FROM v_userinfo LIMIT ?,?";
		PreparedStatement ps = dbUtil.getPreparedStatement(sql);
		ps.setInt(1, (page-1)*limit);
		ps.setInt(2, limit);
		ResultSet rs = ps.executeQuery();
		while (rs.next()) {
			Article article = new Article();
			// 查询user信息
			// 获取userId的值并转换成整型
			article.setUserId(Integer.parseInt(rs.getString("userId")));
			article.setName(rs.getString("name"));
			article.setSex(rs.getString("sex"));
			// 获取age的值并转换成整型
			article.setAge(Integer.parseInt(rs.getString("age")));
			article.setEmail(rs.getString("email"));
			articleList.add(article);
		}
		return articleList;
	}

}
